<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>My Project: Gateway Shadow Controller</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Gateway <a class="el" href="classShadow.html" title="This is the shadow class which is managing the device and performs the delta information. ">Shadow</a> Controller </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<p>Gateway <a class="el" href="classShadow.html" title="This is the shadow class which is managing the device and performs the delta information. ">Shadow</a> Controller is primarily the digital twin of the Cloud <a class="el" href="classShadow.html" title="This is the shadow class which is managing the device and performs the delta information. ">Shadow</a> Controller. Both <a class="el" href="classShadow.html" title="This is the shadow class which is managing the device and performs the delta information. ">Shadow</a> Controllers are almost identical in terms of workflow barring few features.</p>
<p>Shadows are the prime facia of a Device i.e world would not see the device but the shadow as the device and through that it will controlled. A typical shadow contains the most abstracted information of the device that is the properties and their sub-properties. Along with these each property in the shadow has two states 1) reported 2) desired. Reported is current value/state of the device whereas Desired is the state which an external body wants to reach at an interval. <a class="el" href="classShadow.html" title="This is the shadow class which is managing the device and performs the delta information. ">Shadow</a> manages both these states.</p>
<p>Further, a <a class="el" href="classShadow.html" title="This is the shadow class which is managing the device and performs the delta information. ">Shadow</a> is nothing but a json file which is generated from RAML and represents the above mentioned reported and desired state per properties.</p>
<h1><a class="anchor" id="structure_sec"></a>
Structure Of Gateway Shadow Controller</h1>
<p>The structure of <a class="el" href="classShadow.html" title="This is the shadow class which is managing the device and performs the delta information. ">Shadow</a> Controller is primarily divided into three high-level component classes.</p>
<p>1) <a class="el" href="classShadow.html" title="This is the shadow class which is managing the device and performs the delta information. ">Shadow</a> Controller: This is the main manager and interface class between shadows and the Device Object. shadowcontroller is the class which is representing this interface. 2) <a class="el" href="classShadow.html" title="This is the shadow class which is managing the device and performs the delta information. ">Shadow</a>: This is the <a class="el" href="classShadow.html" title="This is the shadow class which is managing the device and performs the delta information. ">Shadow</a> class which manages the actual device shadow which, as I mentioned earlier, is a json file. 3) RAMLPyBinding: This is the class which does the conversion from RAML to Json object.</p>
<p>Although loosely coupled each of the components are linked with each other through contracts. For example, <a class="el" href="classShadow.html" title="This is the shadow class which is managing the device and performs the delta information. ">Shadow</a> Controller class has a contract with <a class="el" href="classShadow.html" title="This is the shadow class which is managing the device and performs the delta information. ">Shadow</a> class but not with RAMLPyBinding class, however, <a class="el" href="classShadow.html" title="This is the shadow class which is managing the device and performs the delta information. ">Shadow</a> class and RAMLPyBinding class for the end JSON file which is our actual <a class="el" href="classShadow.html" title="This is the shadow class which is managing the device and performs the delta information. ">Shadow</a>.</p>
<p>Each structure is laced with exceptions which are pertinent to the structure it is in. Exceptions are raised only when the contract between two components are not fulfilled. Now, it may be origin components' responsibility for the failure or the cloud app or mesh app. The origin is notified of this.</p>
<p>Let us Magnify upon each component, beginning with <a class="el" href="classShadow.html" title="This is the shadow class which is managing the device and performs the delta information. ">Shadow</a> Controller(shadowcontroller) class.</p>
<p>This class does the job of knowing which shadow is the controller of the device. The major components of this class are its functions which are divided into three categories 1) setup 2) searching for &amp; calling shadow's functions 3) forwarding the calls to the protocol layer.</p>
<p>In Setup, we are talking about configurations. A whole lot of configurations that can be either individual shadow dependent or wholistically. Currently, such configurations are yet to be finalized. Other important part of this section is <a class="el" href="classShadow.html" title="This is the shadow class which is managing the device and performs the delta information. ">Shadow</a> Creation which happens when a new Device is added. At this juncture, configuration is also pushed. The <a class="el" href="classShadow.html" title="This is the shadow class which is managing the device and performs the delta information. ">Shadow</a> is saved in a table with key as deviceId and value as the pointer of <a class="el" href="classShadow.html" title="This is the shadow class which is managing the device and performs the delta information. ">Shadow</a> itself.</p>
<p>Commands such as setDeviceState and getDeviceState fall under the second category. In this <a class="el" href="classshadowController.html" title="This is the shadowController class which manages the shadows against their deviceID and acts as inter...">shadowController</a> class finds the shadow and calls that shadow's respective functions given the command. If it doesn't find the shadow, such a message is sent back to the originator.</p>
<p>Last section is the call forwarder i.e providing the gateway from right side of the equation i.e each shadow can use <a class="el" href="classshadowController.html" title="This is the shadowController class which manages the shadows against their deviceID and acts as inter...">shadowController</a>'s functions such as SendTocloud, SendTelemetryDataCCAPP, CallTheInterface(for device interface).</p>
<p><a class="el" href="classshadowController.html" title="This is the shadowController class which manages the shadows against their deviceID and acts as inter...">shadowController</a> class does it all and doesn't use any threads and doesn't maintain any queue for the commands. It simply forwards requests and their responses. </p><hr/>
<p>Next section is <a class="el" href="classShadow.html" title="This is the shadow class which is managing the device and performs the delta information. ">Shadow</a> class. This is the central component of the <a class="el" href="classShadow.html" title="This is the shadow class which is managing the device and performs the delta information. ">Shadow</a> Controller. This class does the following tasks:-</p>
<p>1) Maintains Json file shadows(updation of values(reported &amp; desired), updation of files). 2) Finds Delta for the properties. 3) Gives the reported values.</p>
<p>Each shadow does its task independent of other shadows using threads. Each shadow has a thread associated with it. This thread is task based, if it gets the tasks then only it runs otherwise it sleeps i.e not running in a continuous loop eating machine cycles.</p>
<h1><a class="anchor" id="architecture_sec"></a>
Workflow Of Gateway Shadow Controller.</h1>
<p>If we discuss the set device state through shadow controller workflow is</p>
<p>1) Command comes for device object which forwards to <a class="el" href="classShadow.html" title="This is the shadow class which is managing the device and performs the delta information. ">Shadow</a> Controller. 2) <a class="el" href="classShadow.html" title="This is the shadow class which is managing the device and performs the delta information. ">Shadow</a> Controller finds Shadows which will find the Delta given the Job. 3) Suppose Delta is present, now comes the conditions i.e workflow related. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
